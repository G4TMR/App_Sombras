<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciar Campanha | Sombras do Abismo</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>
<body data-page="campanhas">
    <div class="background-overlay"></div>
    <div id="header-placeholder"></div>

    <main class="main-content" id="campaign-management-container" style="display: none;">
        <a href="campanhas.html" class="back-to-list-btn">&larr; Voltar para Campanhas</a>
        <div class="campaign-layout">
            <div class="campaign-main-content">
                <div class="content-box">
                    <div class="campaign-display-header">
                        <div id="campaign-cover-image-display" class="campaign-cover-image"></div>
                        <div class="campaign-title-section">
                            <h2 id="campaign-title-display">Carregando...</h2>
                            <p id="campaign-synopsis-display" class="info-text"></p>
                            <button id="edit-campaign-info-btn" class="wizard-btn">Editar Informa√ß√µes</button>
                        </div>
                    </div>
        
                    <!-- Abas do Mestre -->
                    <div class="master-tabs">
                        <button class="tab-link active" data-tab="escudo-mestre">Escudo do Mestre</button>
                        <button class="tab-link" data-tab="mapa">Mapa</button>
                    </div>
        
                    <!-- Conte√∫do das Abas -->
                    <div class="tab-content active" id="escudo-mestre">
                        <h4>Recursos do Mestre</h4>
                        <p>Aqui voc√™ ver√° as fichas dos jogadores e monstros. As notifica√ß√µes e rolagens de dados aparecer√£o na barra lateral.</p>
                        <div class="master-tools-grid">
                            <div class="tool-placeholder">Lista de Jogadores</div>
                            <div class="tool-card">
                                <h3>C√≥digo de Convite</h3>
                                <p>Compartilhe este c√≥digo com seus jogadores para que eles possam se juntar √† sua campanha.</p>
                                <div class="invite-code-display">
                                    <span id="campaign-invite-code-display">SDA-XXXX</span>
                                    <button id="generate-invite-code-btn" class="wizard-btn small-btn">Gerar Novo</button>
                                </div>
                            </div>
                            <div class="tool-placeholder">Fichas de Monstros</div>
                        </div>
                    </div>
        
                    <div class="tab-content" id="mapa">
                        <div class="premium-lock">
                            <span class="lock-icon">üîí</span>
                            <h3>Recurso Premium</h3>
                            <p>A funcionalidade de Mapa Interativo est√° dispon√≠vel apenas para apoiadores. Considere se tornar um Patrono para desbloquear este e outros recursos incr√≠veis!</p>
                            <a href="patente.html" class="wizard-btn">Ver Planos de Apoio</a>
                        </div>
                        <div class="map-content-unlocked">
                            <h3>Gerador de Mapa com IA</h3>
                            <p>Descreva o local em detalhes: a atmosfera, pontos de interesse, perigos e a est√©tica geral. A IA usar√° sua sinopse para criar um mapa sombrio e detalhado.</p>
                            <div class="map-generator-container">
                                <textarea id="map-synopsis" placeholder="Ex: Uma mans√£o vitoriana abandonada em uma colina, cercada por uma floresta morta. A n√©voa √© constante. H√° um cemit√©rio nos fundos e a entrada principal est√° arrombada..."></textarea>
                                <button id="generate-map-btn" class="wizard-btn">Gerar Mapa</button>
                                <div id="map-loader" class="map-loader" style="display: none;">
                                    <div class="spinner"></div>
                                </div>
                                <div id="map-display" class="map-display"></div>
                            </div>
                        </div>
                    </div>
        
                    <div class="campaign-actions-footer">
                        <span id="save-status-indicator" class="save-status"></span>
                        <button id="delete-campaign-btn" class="wizard-btn danger-btn">Excluir Campanha</button>
                    </div>
        
                </div>
            </div>

            <aside class="notification-sidebar">
                <div class="sidebar-content">
                    <h3>Log de Atividades</h3>
                    <div id="real-time-log" class="roll-log">
                        <p class="log-placeholder">As rolagens de dados e outras a√ß√µes dos jogadores aparecer√£o aqui.</p>
                    </div>
                </div>
            </aside>
        </div>
    </main>

    <!-- Novo Menu do Jogador -->
    <main class="main-content" id="player-view-container" style="display: none;">
        <a href="campanhas.html" class="back-to-list-btn">&larr; Voltar para Campanhas</a>
        
        <div class="content-box">
            <!-- Cabe√ßalho da Campanha -->
            <div class="campaign-display-header">
                <div id="player-view-campaign-cover" class="campaign-cover-image"></div>
                <div class="campaign-title-section">
                    <h2 id="player-view-campaign-title">Carregando...</h2>
                    <p id="player-view-campaign-synopsis" class="info-text"></p>
                </div>
            </div>
    
            <!-- Agentes na Campanha -->
            <div class="form-section" style="margin-top: 2rem;">
                <h3 class="section-title">Agentes na Campanha</h3>
                <div id="campaign-agents-grid" class="characters-grid">
                    <!-- Cards de personagens ser√£o injetados aqui -->
                </div>
                <div id="no-agents-in-campaign" class="empty-state" style="display: none; padding: 2rem 0;">
                    <p class="empty-message">Nenhum agente nesta campanha ainda.</p>
                    <p class="empty-submessage">Adicione seu primeiro agente para come√ßar a jogar.</p>
                </div>
            </div>
    
            <!-- Bot√£o de A√ß√£o -->
            <div style="text-align:center; margin-top:3rem;">
                <button id="add-agent-to-campaign-btn" class="wizard-btn">Adicionar Agente</button>
            </div>
        </div>
    </main>

    <!-- Modal para Editar Informa√ß√µes da Campanha -->
    <div id="edit-campaign-modal-overlay" class="modal-overlay">
        <div class="specialization-modal-content">
            <h1>Editar Campanha</h1>
            <form id="manage-campaign-form" class="personalization-form" novalidate>
                <div class="form-section" style="background: none; border: none; padding: 0;">
                    <div class="form-group">
                        <label for="campaign-title-modal">T√≠tulo da Campanha</label>
                        <input type="text" id="campaign-title-modal" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="campaign-synopsis-modal">Sinopse</label>
                        <textarea id="campaign-synopsis-modal" name="synopsis"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="campaign-image-modal-input">Imagem de Capa</label>
                        <div class="image-preview-container">
                            <img id="campaign-image-modal-preview" src="https://via.placeholder.com/300x180" alt="Pr√©-visualiza√ß√£o da capa">
                            <input type="file" id="campaign-image-modal-input" name="imageFile" accept="image/*" style="display: none;">
                            <button type="button" class="wizard-btn" onclick="document.getElementById('campaign-image-modal-input').click()">Alterar Imagem</button>
                        </div>
                    </div>
                </div>
            </form>
            <div class="modal-actions" style="margin-top: 2rem;">
                <button id="cancel-edit-btn" class="wizard-btn danger-btn">Cancelar</button>
                <button id="save-edit-btn" class="wizard-btn">Salvar Altera√ß√µes</button>
            </div>
        </div>
    </div>

    <!-- Modal para Adicionar Agente √† Campanha -->
    <div id="add-agent-modal-overlay" class="modal-overlay">
        <div class="specialization-modal-content">
            <h1>Adicionar Agente √† Campanha</h1>
            <p class="info-text">Escolha um dos seus agentes existentes ou crie um novo para se juntar a esta campanha.</p>
            
            <div id="select-agent-list" class="characters-grid modal-character-list">
                <!-- Lista de agentes do usu√°rio para sele√ß√£o -->
            </div>
    
            <div class="modal-actions" style="margin-top: 2rem; border-top: 1px solid var(--color-surface-2); padding-top: 2rem;">
                <button id="cancel-add-agent-btn" class="wizard-btn danger-btn">Cancelar</button>
                <a href="criar-agente.html" id="create-and-add-agent-btn" class="wizard-btn">Criar Novo Agente</a>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="script.js"></script>
</body>
</html>